<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <title>é‹å‹•ç´€éŒ„</title>
  <style>
    body { font-family: "Microsoft JhengHei"; max-width: 800px; margin: 40px auto; }
    table { width: 100%; border-collapse: collapse; margin-top: 20px; }
    th, td { border: 1px solid #ccc; padding: 8px; text-align: center; }
    th { background: #f2f2f2; }
    input, select, textarea { padding: 4px; }
    .btn { padding: 6px 12px; margin-top: 10px; cursor: pointer; }
  </style>
</head>
<body>
  <h1>ğŸƒ é‹å‹•ç´€éŒ„</h1>
  <form id="logForm">
    <label>æ—¥æœŸï¼š<input type="date" id="date" required></label><br><br>
    <label>æ´»å‹•ï¼š
      <select id="activity">
        <option>å¥è¡Œ</option>
        <option>è·‘æ­¥</option>
        <option>é¨è»Š</option>
        <option>æ¸¸æ³³</option>
        <option>çƒé¡</option>
        <option>ç‘œä¼½</option>
        <option>å…¶ä»–</option>
      </select><br>
    </label><br><br>
    <label>æ™‚é–“(åˆ†é˜)ï¼š<input type="number" id="duration" min="1" required></label><br><br>
    <label>å¿ƒç‡ï¼š<input type="number" id="heartRate" min="0"></label><br><br>
    <label>é…é€Ÿï¼š<input type="text" id="pace" placeholder="7'20&quot;"></label><br><br>
    <label>å‚™è¨»ï¼š<textarea id="note" rows="2"></textarea></label><br><br>

    <button type="submit" class="btn">â• æ–°å¢ç´€éŒ„</button>
    <!-- âœ… æ–°å¢åŒ¯å‡ºã€åŒ¯å…¥æŒ‰éˆ• -->
    <button type="button" class="btn" onclick="exportJSON()">ğŸ“¤ åŒ¯å‡ºç´€éŒ„</button>
    <button type="button" class="btn" onclick="importJSON()">ğŸ“¥ åŒ¯å…¥ç´€éŒ„</button>
    <input type="file" id="importFile" accept=".json" style="display:none">
  </form>

  <table id="logTable">
    <thead>
      <tr>
        <th>æ—¥æœŸ</th><th>æ´»å‹•</th><th>æ™‚é–“(åˆ†)</th><th>å¿ƒç‡</th><th>é…é€Ÿ</th><th>å‚™è¨»</th><th>åˆªé™¤</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <script>
    const form = document.getElementById('logForm');
    const tbody = document.querySelector('#logTable tbody');

    function loadLogs() {
      const logs = JSON.parse(localStorage.getItem('workoutLogs') || '[]');
      tbody.innerHTML = '';
      logs.forEach((log, index) => {
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td>${log.date}</td>
          <td>${log.activity}</td>
          <td>${log.duration}</td>
          <td>${log.heartRate}</td>
          <td>${log.pace}</td>
          <td style="white-space: pre-line;">${log.note}</td>
          <td><button onclick="deleteLog(${index})">ğŸ—‘ï¸</button></td>
        `;
        tbody.appendChild(tr);
      });
    }

    function saveLogs(logs) {
      localStorage.setItem('workoutLogs', JSON.stringify(logs));
    }

    form.addEventListener('submit', e => {
      e.preventDefault();
      const log = {
        date: document.getElementById('date').value,
        activity: document.getElementById('activity').value,
        duration: document.getElementById('duration').value,
        heartRate: document.getElementById('heartRate').value,
        pace: document.getElementById('pace').value,
        note: document.getElementById('note').value
      };
      const logs = JSON.parse(localStorage.getItem('workoutLogs') || '[]');
      logs.push(log);
      saveLogs(logs);
      loadLogs();
      form.reset();
    });

    function deleteLog(index) {
      const logs = JSON.parse(localStorage.getItem('workoutLogs') || '[]');
      logs.splice(index, 1);
      saveLogs(logs);
      loadLogs();
    }

    // âœ… åŒ¯å‡ºç´€éŒ„æˆ JSON æª”æ¡ˆ
    function exportJSON() {
      const logs = JSON.parse(localStorage.getItem('workoutLogs') || '[]');
      if (logs.length === 0) {
        alert("ç›®å‰æ²’æœ‰ä»»ä½•ç´€éŒ„å¯åŒ¯å‡ºï¼");
        return;
      }
      const blob = new Blob([JSON.stringify(logs, null, 2)], { type: 'application/json' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = 'workout-data.json';
      a.click();
      URL.revokeObjectURL(url);
      alert("âœ… å·²åŒ¯å‡ºç´€éŒ„æˆ JSON æª”æ¡ˆï¼ˆworkout-data.jsonï¼‰");
    }

    // âœ… åŒ¯å…¥ JSON æª”æ¡ˆä¸¦æ›´æ–° LocalStorage
    function importJSON() {
      document.getElementById('importFile').click();
    }

    document.getElementById('importFile').addEventListener('change', function (e) {
      const file = e.target.files[0];
      if (!file) return;
      const reader = new FileReader();
      reader.onload = function (event) {
        try {
          const logs = JSON.parse(event.target.result);
          if (Array.isArray(logs)) {
            saveLogs(logs);
            loadLogs();
            alert("ğŸ“¥ åŒ¯å…¥æˆåŠŸï¼è³‡æ–™å·²æ›´æ–°ã€‚");
          } else {
            alert("âš ï¸ æª”æ¡ˆæ ¼å¼éŒ¯èª¤ï¼Œè«‹ç¢ºèªæ˜¯æ­£ç¢ºçš„ JSONã€‚");
          }
        } catch (err) {
          alert("âš ï¸ åŒ¯å…¥å¤±æ•—ï¼ŒJSON æ ¼å¼ä¸æ­£ç¢ºã€‚");
        }
      };
      reader.readAsText(file);
      e.target.value = ""; // é‡ç½®æª”æ¡ˆé¸æ“‡å™¨
    });

    loadLogs();
  </script>
</body>
</html>


